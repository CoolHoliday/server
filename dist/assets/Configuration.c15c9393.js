import{r as F,j as v,a as e,J as g,L as d,N as h,d as y,O as k,ah as I}from"./index.60223ae1.js";import{M as C}from"./index.09d92a75.js";import{T as E}from"./Table.4f06e3dc.js";import"./getScrollBarSize.63756edf.js";const w=({updateTableData:n})=>{const[u,p]=F.exports.useState(!1),r=()=>{p(!0)},_=async i=>{try{console.log("Received values in h:",i),console.log(i.device_Id),console.log(i.device_name),console.log(i.device_description),console.log(i.device_kind),console.log(i.device_activate);const a=localStorage.getItem("user");if(a!==null){const m=JSON.parse(a).id,o=await y.post("http://185.196.97.182:8080/api/devices/createDevice",{id:i.device_Id,name:i.device_name,description:i.device_description,userId:m,kind:i.device_kind,activate:i.device_activate}),s=o.data.code,B=o.data.msg;if(console.log(s),console.log(B),s==0){const D={device_id:o.data.data.id,device_name:o.data.data.name,device_description:o.data.data.description,device_kind:o.data.data.kind,device_activate:o.data.data.activate};k.success(B),n(D)}else k.error(B)}p(!1)}catch(a){console.error("Error creating device:",a),p(!1)}},t=()=>{p(!1)};return v("div",{children:[e(g,{type:"primary",onClick:r,children:"\u65B0\u5EFA"}),e(C,{title:"\u65B0\u5EFA\u8BBE\u5907",visible:u,onOk:_,onCancel:t,footer:[],children:v(d,{name:"basic",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:_,onFinishFailed:i=>{console.log("Failed:",i)},children:[e(d.Item,{label:"\u8BBE\u5907ID",name:"device_Id",rules:[{required:!0,message:"Please input your device_Id!"}],children:e(h,{})}),e(d.Item,{label:"\u8BBE\u5907\u540D\u79F0",name:"device_name",rules:[{required:!0,message:"Please input your device_name!"}],children:e(h,{})}),e(d.Item,{label:"\u8BBE\u5907\u578B\u53F7",name:"device_kind",rules:[{required:!0,message:"Please input your device_type!"}],children:e(h,{})}),e(d.Item,{label:"\u8BBE\u5907\u63CF\u8FF0",name:"device_description",rules:[{required:!0,message:"Please input your device_description!"}],children:e(h,{})}),e(d.Item,{label:"\u8BBE\u5907\u72B6\u6001",name:"device_activate",rules:[{required:!0,message:"Please input your device_activate!"}],children:e(h,{})}),v(d.Item,{wrapperCol:{offset:6,span:16},children:[e(g,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"}),e(g,{onClick:t,children:"\u53D6\u6D88"},"back")]})]})})]})},M=({deviceId:n,onDelete:u})=>{const[p,r]=F.exports.useState(!1),_=()=>{r(!0)},t=async()=>{try{console.log("handle ok");const m=await y.post("http://185.196.97.182:8080/api/devices/deleteDevice/"+n),o=m.data.code,s=m.data.msg;console.log(o),console.log(s),o==0&&(u(n),k.success(s)),r(!1)}catch(m){console.error("Error creating device:",m)}console.log("handle ok");const i=await y.post("http://185.196.97.182:8080/api/devices/deleteDevice/"+n),a=i.data.code,l=i.data.msg;console.log(a),console.log(l),a==0&&(u(n),k.success(l)),r(!1)},c=()=>{r(!1)};return v("div",{children:[e(g,{type:"primary",onClick:_,children:"\u5220\u9664"}),e(C,{title:"\u5220\u9664\u8BBE\u5907",visible:p,onOk:t,onCancel:c,footer:[e(g,{type:"primary",onClick:t,children:"\u786E\u5B9A"},"submit"),e(g,{onClick:c,children:"\u53D6\u6D88"},"back")],children:e("p",{children:"\u6CE8\u610F\uFF1A\u5220\u9664\u64CD\u4F5C\u65E0\u6CD5\u6062\u590D\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\u3002"})})]})},S=({deviceId:n,onModify:u})=>{const[p,r]=F.exports.useState(!1),_=()=>{r(!0)},t=async a=>{try{console.log("Received values in h:",a),console.log(a.device_name),console.log(a.device_description),console.log(a.device_kind),console.log(a.device_activate);const l=localStorage.getItem("user");if(console.log(l),l!==null){const o=JSON.parse(l).id,s=await y.post("http://185.196.97.182:8080/api/devices/updateDevice/"+n,{id:n,name:a.device_name,description:a.device_description,userId:o,kind:a.device_kind,activate:a.device_activate}),B=s.data.code,D=s.data.msg;if(console.log(s.data.data),console.log(B),console.log(D),B==0){const b={device_id:s.data.data.id,device_name:s.data.data.name,device_description:s.data.data.description,device_kind:s.data.data.kind,device_activate:s.data.data.activate};console.log("this is"),console.log(b),u(n,b)}}r(!1)}catch(l){console.error("Error creating device:",l)}},c=()=>{r(!1)};return v("div",{children:[e(g,{type:"primary",onClick:_,children:"\u66F4\u6539"}),e(C,{title:"\u66F4\u6539\u8BBE\u5907",visible:p,onOk:t,onCancel:c,footer:[],children:v(d,{name:"basic",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:t,onFinishFailed:a=>{console.log("Failed:",a)},children:[e(d.Item,{label:"\u8BBE\u5907\u540D\u79F0",name:"device_name",rules:[{required:!0,message:"Please input your device_name!"}],children:e(h,{})}),e(d.Item,{label:"\u8BBE\u5907\u578B\u53F7",name:"device_kind",rules:[{required:!0,message:"Please input your device_kind!"}],children:e(h,{})}),e(d.Item,{label:"\u8BBE\u5907\u63CF\u8FF0",name:"device_description",rules:[{required:!0,message:"Please input your device_description!"}],children:e(h,{})}),e(d.Item,{label:"\u8BBE\u5907\u72B6\u6001",name:"device_activate",rules:[{required:!0,message:"Please input your device_activate!"}],children:e(h,{})}),v(d.Item,{wrapperCol:{offset:6,span:16},children:[e(g,{type:"primary",htmlType:"submit",children:"\u786E\u5B9A"}),e(g,{onClick:c,children:"\u53D6\u6D88"},"back")]})]})})]})};const{Column:f}=E,V=()=>{const[n,u]=F.exports.useState([]);F.exports.useEffect(()=>{(async()=>{try{const c=localStorage.getItem("user");if(c!==null){const a=JSON.parse(c).id,l=await y.get(`http://185.196.97.182:8080/api/devices/getAllDevices/${a}`);if(l.status==200){const m=l.data.map(o=>({device_id:o.data.id,device_name:o.data.name,device_description:o.data.description,device_kind:o.data.kind,device_activate:o.data.activate}));u(m)}}}catch(c){console.error("Error fetching data:",c)}})()},[n]);const p=t=>{n.push(t)},r=t=>{console.log(`Deleting device with ID: ${t}`);const c=n.filter(i=>i.device_id!==t);u(c)},_=(t,c)=>{console.log(`Modifying device with ID: ${t}`);const i=n.filter(a=>a.device_id!==t);i.push(c),u(i)};return e("div",{className:"configurationPage",children:v("div",{className:"configurationTable",children:[" ",v(E,{dataSource:n,children:[e(f,{title:"\u8BBE\u5907ID",dataIndex:"device_id"},"device_id"),e(f,{title:"\u8BBE\u5907\u540D\u79F0",dataIndex:"device_name"},"device_name"),e(f,{title:"\u8BBE\u5907\u578B\u53F7",dataIndex:"device_kind"},"device_kind"),e(f,{title:"\u8BBE\u5907\u63CF\u8FF0",dataIndex:"device_description"},"device_description"),e(f,{title:"\u8BBE\u5907\u72B6\u6001",dataIndex:"device_activate"},"device_activate"),e(f,{title:"Action",render:(t,c)=>v(I,{size:"middle",children:[e(M,{deviceId:c.device_id,onDelete:r}),e(S,{deviceId:c.device_id,onModify:_})]})},"action")]}),e(w,{updateTableData:p})]})})};export{V as default};
