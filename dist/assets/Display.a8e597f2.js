import{aZ as P,r as y,j as U,a as A,L as m,N as k,J as F,d as j}from"./index.60223ae1.js";var L={exports:{}};(function(g,I){(function(c,h){g.exports=h()})(P,function(){function c(e){var r=[];return e.AMapUI&&r.push(h(e.AMapUI)),e.Loca&&r.push(b(e.Loca)),Promise.all(r)}function h(e){return new Promise(function(r,a){var s=[];if(e.plugins)for(var t=0;t<e.plugins.length;t+=1)n.AMapUI.plugins.indexOf(e.plugins[t])==-1&&s.push(e.plugins[t]);if(i.AMapUI===o.failed)a("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(i.AMapUI===o.notload){i.AMapUI=o.loading,n.AMapUI.version=e.version||n.AMapUI.version,t=n.AMapUI.version;var d=document.body||document.head,p=document.createElement("script");p.type="text/javascript",p.src="https://webapi.amap.com/ui/"+t+"/main.js",p.onerror=function(l){i.AMapUI=o.failed,a("\u8BF7\u6C42 AMapUI \u5931\u8D25")},p.onload=function(){if(i.AMapUI=o.loaded,s.length)window.AMapUI.loadUI(s,function(){for(var l=0,f=s.length;l<f;l++){var M=s[l].split("/").slice(-1)[0];window.AMapUI[M]=arguments[l]}for(r();u.AMapUI.length;)u.AMapUI.splice(0,1)[0]()});else for(r();u.AMapUI.length;)u.AMapUI.splice(0,1)[0]()},d.appendChild(p)}else i.AMapUI===o.loaded?e.version&&e.version!==n.AMapUI.version?a("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):s.length?window.AMapUI.loadUI(s,function(){for(var l=0,f=s.length;l<f;l++){var M=s[l].split("/").slice(-1)[0];window.AMapUI[M]=arguments[l]}r()}):r():e.version&&e.version!==n.AMapUI.version?a("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):u.AMapUI.push(function(l){l?a(l):s.length?window.AMapUI.loadUI(s,function(){for(var f=0,M=s.length;f<M;f++){var x=s[f].split("/").slice(-1)[0];window.AMapUI[x]=arguments[f]}r()}):r()})})}function b(e){return new Promise(function(r,a){if(i.Loca===o.failed)a("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(i.Loca===o.notload){i.Loca=o.loading,n.Loca.version=e.version||n.Loca.version;var s=n.Loca.version,t=n.AMap.version.startsWith("2"),d=s.startsWith("2");if(t&&!d||!t&&d)a("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{t=n.key,d=document.body||document.head;var p=document.createElement("script");p.type="text/javascript",p.src="https://webapi.amap.com/loca?v="+s+"&key="+t,p.onerror=function(l){i.Loca=o.failed,a("\u8BF7\u6C42 AMapUI \u5931\u8D25")},p.onload=function(){for(i.Loca=o.loaded,r();u.Loca.length;)u.Loca.splice(0,1)[0]()},d.appendChild(p)}}else i.Loca===o.loaded?e.version&&e.version!==n.Loca.version?a("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):r():e.version&&e.version!==n.Loca.version?a("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):u.Loca.push(function(l){l?a(l):a()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var o;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(o||(o={}));var n={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},u={AMap:[],AMapUI:[],Loca:[]},v=[],w=function(e){typeof e=="function"&&(i.AMap===o.loaded?e(window.AMap):v.push(e))};return{load:function(e){return new Promise(function(r,a){if(i.AMap==o.failed)a("");else if(i.AMap==o.notload){var s=e.key,t=e.version,d=e.plugins;s?(window.AMap&&location.host!=="lbs.amap.com"&&a("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),n.key=s,n.AMap.version=t||n.AMap.version,n.AMap.plugins=d||n.AMap.plugins,i.AMap=o.loading,t=document.body||document.head,window.___onAPILoaded=function(l){if(delete window.___onAPILoaded,l)i.AMap=o.failed,a(l);else for(i.AMap=o.loaded,c(e).then(function(){r(window.AMap)}).catch(a);v.length;)v.splice(0,1)[0]()},d=document.createElement("script"),d.type="text/javascript",d.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+n.AMap.version+"&key="+s+"&plugin="+n.AMap.plugins.join(","),d.onerror=function(l){i.AMap=o.failed,a(l)},t.appendChild(d)):a("\u8BF7\u586B\u5199key")}else if(i.AMap==o.loaded)if(e.key&&e.key!==n.key)a("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(e.version&&e.version!==n.AMap.version)a("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(s=[],e.plugins)for(t=0;t<e.plugins.length;t+=1)n.AMap.plugins.indexOf(e.plugins[t])==-1&&s.push(e.plugins[t]);s.length?window.AMap.plugin(s,function(){c(e).then(function(){r(window.AMap)}).catch(a)}):c(e).then(function(){r(window.AMap)}).catch(a)}else if(e.key&&e.key!==n.key)a("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(e.version&&e.version!==n.AMap.version)a("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var p=[];if(e.plugins)for(t=0;t<e.plugins.length;t+=1)n.AMap.plugins.indexOf(e.plugins[t])==-1&&p.push(e.plugins[t]);w(function(){p.length?window.AMap.plugin(p,function(){c(e).then(function(){r(window.AMap)}).catch(a)}):c(e).then(function(){r(window.AMap)}).catch(a)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,n={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},u={AMap:[],AMapUI:[],Loca:[]}}}})})(L);var C=L.exports;const _=()=>{const[g,I]=y.exports.useState([]);function c(){let o=null;return y.exports.useEffect(()=>(C.load({key:"	91e346219c66c38aedfdbc1c2be34935",version:"1.4.15",plugins:[]}).then(n=>{o=new n.Map("container",{viewMode:"2D",zoom:10,center:[120.19,30.26]});const i=[];g.forEach(e=>{console.log("hello"),i.push({lnglat:[e.lng,e.lat],timestamp:new Date(e.stamp).getTime()})});const u=g[0];if(u&&typeof u=="object"){const{lng:e,lat:r}=u;console.log("Lng:",e),console.log("Lat:",r)}else console.error("The data array is empty or does not have the expected structure.");var v=new n.Marker({map:o,position:[u.lng,u.lat],icon:"https://webapi.amap.com/images/car.png",offset:new n.Pixel(-26,-13),autoRotation:!0,angle:-90});const w=new n.Polyline({path:i.map(e=>e.lnglat),borderWeight:1,strokeStyle:"solid",strokeColor:"green",lineJoin:"round",showDir:!0,strokeDasharray:[10,5]});o!=null&&(o.add(w),v.moveAlong(i.map(e=>e.lnglat),1e4))}),()=>{o==null||o.destroy()}),[]),A("div",{id:"container",style:{height:"600px"}})}return U("div",{className:"Display",children:[A("div",{className:"Form",children:U(m,{name:"basic",labelCol:{},wrapperCol:{},style:{},initialValues:{remember:!0},onFinish:async o=>{console.log(o);const n=await j.get("http://185.196.97.182:8080/api/messages/path/"+o.deviceId);if(n.status==200){const i=n.data.map(u=>({id:u.data.id,deviceId:u.data.deviceId,alert:u.data.alert,info:u.data.info,lat:u.data.lat,lng:u.data.lng,stamp:u.data.stamp,value:u.data.value}));console.log(g),I(i)}},onFinishFailed:o=>{console.log("Failed:",o)},autoComplete:"off",children:[A(m.Item,{label:"\u8BF7\u8F93\u5165\u8BBE\u5907ID",name:"deviceId",rules:[{required:!0,message:"Please input your device's ID!"}],children:A(k,{})}),A(m.Item,{wrapperCol:{},children:A(F,{type:"primary",htmlType:"submit",children:"Submit"})})]})}),A("div",{className:"map",children:A(c,{})})]})};export{_ as default};
